"use strict";function formatCardCode(){var e=this.value.replace(/[^\d]/g,"").substring(0,16);e=""!=e?e.match(/.{1,4}/g).join(" "):"",this.value=e}function getChar(e){return null==e.which?e.keyCode<32?null:String.fromCharCode(e.keyCode):0!=e.which&&0!=e.charCode?e.which<32?null:String.fromCharCode(e.which):null}function qsAll(e){return[].slice.call(document.querySelectorAll(e))}function changeCount(e){initial_state.license+=e,initial_state.license<0&&(initial_state.license=0),license.innerHTML=initial_state.license,calculate()}function calculate(){var e=document.querySelector(".js-time-change:checked").dataset.time;lisence_count=initial_state.license;var n;license_count_value.forEach(function(e){e.innerHTML=lisence_count}),time_price.forEach(function(e,n){1==e.dataset.time?e.innerHTML="$0":e.innerHTML="$"+(e.dataset.time*lisence_count*initial_state.cost).toFixed(2)}),discount.forEach(function(e){var t=e.dataset.time;n=Math.ceil(lisence_count*sale[t]),e.innerHTML="$"+n+" off"}),discount_total.forEach(function(n){var t;t=lisence_count>=3?Math.ceil(lisence_count*sale[e]):0,n.innerHTML="$"+t+" off"}),total.forEach(function(n,t){1==e?n.innerHTML="$0":n.innerHTML="$"+(e*lisence_count*initial_state.cost-sale[e]*lisence_count).toFixed(2)})}function changeSizeWindow(){document.body.clientWidth=document.body.scroll}var btn_open_modal=qsAll(".js-modal-open"),modal=document.querySelector(".js-modal"),modal_wrap=document.querySelector(".js-modal-wrap"),background=document.querySelector(".js-background"),open_coupone_input=document.querySelector(".js-open-coupone-input"),open_coupone_btn=document.querySelector(".js-open-coupone-btn"),close_modal=document.querySelector(".js-close-modal"),open_new_card=document.querySelector(".js-open-form"),close_new_card=document.querySelector(".js-close-form"),new_card=document.querySelector(".js-form"),initial_state={license:3,cost:5.99},sale={1:0,6:10,9:15,12:25,24:40},discount=qsAll(".js-sale"),discount_total=qsAll(".js-total-sale"),total=qsAll(".js-total-price"),license=document.querySelector(".js-license-count"),lisence_count,license_reduction=document.querySelector(".js-reduction"),license_raising=document.querySelector(".js-raising"),time_price=qsAll(".js-time-price"),radio=qsAll(".js-time-change"),input_number=qsAll(".js-number"),input_number_new_card=document.querySelector(".js-number-new-card"),license_count_value=qsAll(".js-license-count-value"),input_month=document.querySelector(".js-input-month"),billing=document.querySelector(".js-billing");license.innerHTML=initial_state.license,btn_open_modal.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),modal.classList.add("open"),document.body.style.overflow="hidden",billing.classList.add("scroll")})}),open_coupone_input.addEventListener("click",function(e){e.preventDefault(),open_coupone_btn.classList.toggle("btn-open")}),close_modal.addEventListener("click",function(){modal.classList.remove("open"),document.body.style.overflow="auto",billing.classList.remove("scroll")}),background.addEventListener("click",function(){modal.classList.remove("open"),document.body.style.overflow="auto",billing.classList.remove("scroll")}),license_reduction.addEventListener("click",function(){initial_state.license>3&&changeCount(-1)}),license_raising.addEventListener("click",function(){changeCount(1)}),radio.forEach(function(e){e.addEventListener("change",calculate)}),calculate(),input_number.forEach(function(e){e.onkeypress=function(e){if(e=e||event,!(e.ctrlKey||e.altKey||e.metaKey)){var n=getChar(e);if(null!=n)return!(n<"0"||n>"9")&&void 0}}}),input_month.onkeyup=function(e){var n=input_month.value,t=n.match(/\b([0-9]|1[0-2])\b/g);null==t&&(input_month.value="")},input_number_new_card.addEventListener("keypress",formatCardCode,!1),changeSizeWindow();